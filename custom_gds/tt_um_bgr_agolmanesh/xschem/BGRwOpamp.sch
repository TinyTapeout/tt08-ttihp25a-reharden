v {xschem version=3.4.5 file_version=1.2
}
G {}
K {}
V {}
S {}
E {}
B 2 -30 -710 770 -310 {flags=graph
y1=0
y2=2
ypos1=0
ypos2=2
divy=5
subdivy=1
unity=1
x1=-2.5e-06
x2=4.75e-05
divx=5
subdivx=1
xlabmag=1.0
ylabmag=1.0
node="vdd
vbgr"
color="6 5"
dataset=-1
unitx=1
logx=0
logy=0
}
B 2 -30 -295 770 105 {flags=graph
y1=0
y2=2
ypos1=0
ypos2=2
divy=5
subdivy=1
unity=1
x1=-2.5e-06
x2=4.75e-05
divx=5
subdivx=1
xlabmag=1.0
ylabmag=1.0
node="vx
vy
minus
plus"
color="5 10 12 14"
dataset=-1
unitx=1
logx=0
logy=0
}
N -1180 -110 -1180 -35 {
lab=VSS}
N -1480 -110 -1480 -35 {
lab=VSS}
N -1140 -140 -1100 -140 {
lab=VSS}
N -1555 -140 -1520 -140 {
lab=VSS}
N -955 -555 -955 -480 {
lab=VDD}
N -1475 -555 -955 -555 {
lab=VDD}
N -1480 -555 -1480 -485 {
lab=VDD}
N -1180 -555 -1180 -485 {
lab=VDD}
N -1435 -455 -1230 -455 {
lab=CMG}
N -1280 -605 -1280 -555 {
lab=VDD}
N -1055 -450 -995 -450 {
lab=CMG}
N -1335 -470 -1335 -455 {
lab=CMG}
N -1180 -200 -1180 -170 {
lab=#net1}
N -1180 -310 -1180 -260 {
lab=PLUS}
N -1480 -310 -1480 -170 {
lab=MINUS}
N -1480 -310 -1475 -310 {
lab=MINUS}
N -1050 -310 -1050 -265 {
lab=PLUS}
N -1185 -310 -1050 -310 {
lab=PLUS}
N -1585 -310 -1480 -310 {
lab=MINUS}
N -1585 -310 -1585 -255 {
lab=MINUS}
N -1585 -195 -1585 -175 {
lab=VSS}
N -1050 -205 -1050 -180 {
lab=VSS}
N -955 -275 -955 -230 {
lab=VSS}
N -1230 -455 -1220 -455 {
lab=CMG}
N -1480 -555 -1475 -555 {
lab=VDD}
N -1440 -455 -1435 -455 {
lab=CMG}
N -1185 -455 -1155 -455 {
lab=VDD}
N -1155 -490 -1155 -455 {
lab=VDD}
N -1180 -490 -1155 -490 {
lab=VDD}
N -960 -450 -935 -450 {
lab=VDD}
N -935 -485 -935 -450 {
lab=VDD}
N -955 -485 -935 -485 {
lab=VDD}
N -1505 -455 -1475 -455 {
lab=VDD}
N -1505 -490 -1505 -455 {
lab=VDD}
N -1505 -490 -1480 -490 {
lab=VDD}
N -955 -365 -905 -365 {
lab=Vbgr}
N -1480 -425 -1480 -405 {
lab=#net2}
N -1480 -345 -1480 -310 {
lab=MINUS}
N -1180 -345 -1180 -310 {
lab=PLUS}
N -1180 -425 -1180 -405 {
lab=#net3}
N -955 -345 -955 -335 {
lab=Vbgr}
N -955 -420 -955 -405 {
lab=Vbgr}
N -955 -405 -955 -345 {
lab=Vbgr}
N -855 -500 -855 -465 {
lab=VDD}
N -955 -500 -855 -500 {
lab=VDD}
N -855 -425 -855 -415 {
lab=Vbgr}
N -955 -415 -855 -415 {
lab=Vbgr}
N -1095 -505 -1095 -480 {
lab=VDD}
N -1180 -505 -1095 -505 {
lab=VDD}
N -1095 -440 -1095 -410 {
lab=#net3}
N -1180 -410 -1095 -410 {
lab=#net3}
N -1585 -505 -1585 -480 {
lab=VDD}
N -1585 -505 -1480 -505 {
lab=VDD}
N -1585 -440 -1585 -420 {
lab=#net2}
N -1585 -420 -1480 -420 {
lab=#net2}
N -1855 -440 -1730 -440 {
lab=CMG}
N -2115 -285 -1855 -285 {
lab=#net4}
N -1990 -285 -1990 -215 {
lab=#net4}
N -2305 -95 -2165 -95 {
lab=#net5}
N -2165 -95 -2030 -95 {
lab=#net5}
N -2345 -145 -2275 -145 {
lab=#net5}
N -2275 -145 -2275 -95 {
lab=#net5}
N -1990 -65 -1990 -30 {
lab=VSS}
N -2345 -65 -2345 -30 {
lab=VSS}
N -1990 -95 -1950 -95 {
lab=VSS}
N -1950 -95 -1950 -40 {
lab=VSS}
N -1990 -40 -1950 -40 {
lab=VSS}
N -2380 -95 -2345 -95 {
lab=VSS}
N -2380 -95 -2380 -35 {
lab=VSS}
N -2380 -35 -2345 -35 {
lab=VSS}
N -2115 -330 -2115 -285 {
lab=#net4}
N -1855 -330 -1855 -285 {
lab=#net4}
N -1855 -405 -1855 -390 {
lab=CMG}
N -1855 -475 -1855 -405 {
lab=CMG}
N -2115 -475 -2115 -390 {
lab=#net6}
N -2075 -505 -1895 -505 {
lab=#net6}
N -2115 -450 -2060 -450 {
lab=#net6}
N -1855 -590 -1855 -535 {
lab=VDD}
N -2115 -590 -1855 -590 {
lab=VDD}
N -2115 -590 -2115 -535 {
lab=VDD}
N -1990 -615 -1990 -590 {
lab=VDD}
N -2115 -360 -2065 -360 {
lab=VSS}
N -1900 -400 -1900 -360 {
lab=VSS}
N -1900 -360 -1855 -360 {
lab=VSS}
N -2065 -390 -2065 -360 {
lab=VSS}
N -2015 -410 -2015 -385 {
lab=#net6}
N -2115 -410 -2015 -410 {
lab=#net6}
N -2015 -345 -2015 -285 {
lab=#net4}
N -1955 -345 -1955 -285 {
lab=#net4}
N -1955 -410 -1955 -385 {
lab=CMG}
N -1955 -410 -1855 -410 {
lab=CMG}
N -2215 -360 -2155 -360 {
lab=PLUS}
N -1815 -360 -1750 -360 {
lab=MINUS}
N -2145 -505 -2115 -505 {
lab=VDD}
N -2145 -560 -2145 -505 {
lab=VDD}
N -2145 -560 -2115 -560 {
lab=VDD}
N -1860 -505 -1830 -505 {
lab=VDD}
N -1830 -555 -1830 -505 {
lab=VDD}
N -1855 -555 -1830 -555 {
lab=VDD}
N -2225 -545 -2225 -520 {
lab=VDD}
N -2225 -545 -2115 -545 {
lab=VDD}
N -2225 -450 -2115 -450 {
lab=#net6}
N -2225 -480 -2225 -450 {
lab=#net6}
N -1740 -565 -1740 -525 {
lab=VDD}
N -1855 -565 -1740 -565 {
lab=VDD}
N -1740 -485 -1740 -470 {
lab=CMG}
N -1740 -470 -1740 -465 {
lab=CMG}
N -1855 -465 -1740 -465 {
lab=CMG}
N -1875 -150 -1875 -95 {
lab=#net7}
N -1990 -150 -1875 -150 {
lab=#net7}
N -1875 -55 -1875 -35 {
lab=VSS}
N -1990 -35 -1875 -35 {
lab=VSS}
N -2440 -140 -2440 -120 {
lab=#net5}
N -2440 -140 -2345 -140 {
lab=#net5}
N -2440 -80 -2440 -35 {
lab=VSS}
N -2440 -35 -2380 -35 {
lab=VSS}
N -1990 -155 -1990 -125 {
lab=#net7}
N -2345 -590 -2115 -590 {
lab=VDD}
N -2345 -590 -2345 -540 {
lab=VDD}
N -2305 -510 -2280 -510 {
lab=vp}
N -2370 -510 -2340 -510 {
lab=VDD}
N -2370 -550 -2370 -510 {
lab=VDD}
N -2370 -550 -2345 -550 {
lab=VDD}
N -2345 -480 -2345 -420 {
lab=#net8}
N -2440 -480 -2440 -470 {
lab=#net8}
N -2440 -470 -2345 -470 {
lab=#net8}
N -2440 -555 -2440 -520 {
lab=VDD}
N -2440 -555 -2345 -555 {
lab=VDD}
N -2020 -520 -2020 -505 {
lab=#net6}
N -2020 -590 -2020 -560 {
lab=VDD}
N -2345 -365 -2345 -125 {
lab=#net5}
N -2060 -450 -2045 -450 {
lab=#net6}
N -2045 -505 -2045 -450 {
lab=#net6}
N -1015 -110 -950 -110 {
lab=Vbgr}
N -915 -110 -890 -110 {
lab=CMG}
N -890 -155 -890 -110 {
lab=CMG}
N -910 -155 -890 -155 {
lab=CMG}
N -910 -155 -910 -140 {
lab=CMG}
C {sky130_fd_pr/pnp_05v5.sym} -1500 -140 0 0 {name=Q1
model=pnp_05v5_W3p40L3p40
m=1
spiceprefix=X
}
C {sky130_fd_pr/pnp_05v5.sym} -1160 -140 0 1 {name=Q2
model=pnp_05v5_W3p40L3p40
m=13
spiceprefix=X
}
C {devices/lab_pin.sym} -1480 -35 0 0 {name=p1 sig_type=std_logic lab=VSS}
C {devices/lab_pin.sym} -1180 -35 0 0 {name=p2 sig_type=std_logic lab=VSS
}
C {devices/lab_pin.sym} -1555 -140 0 0 {name=p3 sig_type=std_logic lab=VSS}
C {devices/lab_pin.sym} -1100 -140 0 1 {name=p4 sig_type=std_logic lab=VSS
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -1460 -455 0 1 {name=M1
L=0.5
W=20
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -1200 -455 0 0 {name=M2
L=0.5
W=20
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -975 -450 0 0 {name=M3
L=0.5
W=20
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {devices/lab_pin.sym} -1280 -605 0 1 {name=p5 sig_type=std_logic lab=VDD
}
C {devices/lab_pin.sym} -1335 -470 0 1 {name=p6 sig_type=std_logic lab=CMG
}
C {devices/lab_pin.sym} -1055 -450 2 1 {name=p7 sig_type=std_logic lab=CMG
}
C {devices/res.sym} -1180 -230 0 0 {name=R1
value= 6k
footprint=1206
device=resistor
m=1}
C {devices/res.sym} -1050 -235 0 0 {name=R2
value=44k
footprint=1206
device=resistor
m=1}
C {devices/res.sym} -1585 -225 0 0 {name=R3
value=44k
footprint=1206
device=resistor
m=1}
C {devices/lab_pin.sym} -1585 -175 0 0 {name=p8 sig_type=std_logic lab=VSS}
C {devices/lab_pin.sym} -1050 -180 0 1 {name=p9 sig_type=std_logic lab=VSS
}
C {devices/res.sym} -955 -305 0 0 {name=R4
value=48k
footprint=1206
device=resistor
m=1}
C {devices/lab_pin.sym} -955 -230 0 1 {name=p10 sig_type=std_logic lab=VSS
}
C {devices/lab_pin.sym} -1475 -310 0 1 {name=p11 sig_type=std_logic lab=MINUS
}
C {devices/lab_pin.sym} -1185 -310 2 1 {name=p12 sig_type=std_logic lab=PLUS
}
C {devices/lab_pin.sym} -905 -365 0 1 {name=p13 sig_type=std_logic lab=Vbgr

}
C {devices/vsource.sym} -685 -605 0 0 {name=V1 value=1.8 savecurrent=false
}
C {devices/vsource.sym} -775 -605 0 0 {name=V2 value=0 savecurrent=false}
C {devices/gnd.sym} -685 -575 0 0 {name=l1 lab=GND
}
C {devices/gnd.sym} -775 -575 0 0 {name=l2 lab=GND}
C {devices/lab_pin.sym} -775 -635 1 0 {name=p14 sig_type=std_logic lab=VSS}
C {devices/lab_pin.sym} -685 -635 3 1 {name=p15 sig_type=std_logic lab=VDD
}
C {devices/simulator_commands.sym} -590 -485 0 0 {name=COMMANDS
simulator=ngspice
only_toplevel=false
place=end
value="
.options savecurrents
.control


save @m.xm1.msky130_fd_pr__ppet_01v8_lvt[gm]
save @m.xm1.msky130_fd_pr__pfet_01v8_lvt[id]
save @m.xm1.msky130_fd_pr__pfet_01v8_lvt[vgs]
save @m.xm1.msky130_fd_pr__pfet_01v8_lvt[vds]
save @m.xm1.msky130_fd_pr__pfet_01v8_lvt[cgg]
save @m.xm1.msky130_fd_pr__pfet_01v8_lvt[vdsat]
save @m.xm1.msky130_fd_pr__pfet_01v8_lvt[vth]


save @m.xm2.msky130_fd_pr__pfet_01v8_lvt[gm]
save @m.xm2.msky130_fd_pr__pfet_01v8_lvt[id]
save @m.xm2.msky130_fd_pr__pfet_01v8_lvt[vgs]
save @m.xm2.msky130_fd_pr__pfet_01v8_lvt[vds]
save @m.xm2.msky130_fd_pr__pfet_01v8_lvt[cgg]
save @m.xm2.msky130_fd_pr__pfet_01v8_lvt[vdsat]
save @m.xm2.msky130_fd_pr__pfet_01v8_lvt[vth]


save @m.xm3.msky130_fd_pr__pfet_01v8_lvt[gm]
save @m.xm3.msky130_fd_pr__pfet_01v8_lvt[id]
save @m.xm3.msky130_fd_pr__pfet_01v8_lvt[vgs]
save @m.xm3.msky130_fd_pr__pfet_01v8_lvt[vds]
save @m.xm3.msky130_fd_pr__pfet_01v8_lvt[cgg]
save @m.xm3.msky130_fd_pr__pfet_01v8_lvt[vdsat]
save @m.xm3.msky130_fd_pr__pfet_01v8_lvt[vth]

save @q.xq1.qsky130_fd_pr__pnp_05v5_W3p40L3p40[vbe]
save @q.xq2.qsky130_fd_pr__pnp_05v5_W3p40L3p40[vbe]


save @m.xm6.msky130_fd_pr__pfet_01v8_lvt[gm]
save @m.xm6.msky130_fd_pr__pfet_01v8_lvt[id]
save @m.xm6.msky130_fd_pr__pfet_01v8_lvt[vgs]
save @m.xm6.msky130_fd_pr__pfet_01v8_lvt[vds]
save @m.xm6.msky130_fd_pr__pfet_01v8_lvt[cgg]
save @m.xm6.msky130_fd_pr__pfet_01v8_lvt[vdsat]
save @m.xm6.msky130_fd_pr__pfet_01v8_lvt[vth]

save @m.xm7.msky130_fd_pr__pfet_01v8_lvt[gm]
save @m.xm7.msky130_fd_pr__pfet_01v8_lvt[id]
save @m.xm7.msky130_fd_pr__pfet_01v8_lvt[vgs]
save @m.xm7.msky130_fd_pr__pfet_01v8_lvt[vds]
save @m.xm7.msky130_fd_pr__pfet_01v8_lvt[cgg]
save @m.xm7.msky130_fd_pr__pfet_01v8_lvt[vdsat]
save @m.xm7.msky130_fd_pr__pfet_01v8_lvt[vth]



save @m.xm8.msky130_fd_pr__pfet_01v8_lvt[gm]
save @m.xm8.msky130_fd_pr__pfet_01v8_lvt[id]
save @m.xm8.msky130_fd_pr__pfet_01v8_lvt[vgs]
save @m.xm8.msky130_fd_pr__pfet_01v8_lvt[vds]
save @m.xm8.msky130_fd_pr__pfet_01v8_lvt[cgg]
save @m.xm8.msky130_fd_pr__pfet_01v8_lvt[vdsat]
save @m.xm8.msky130_fd_pr__pfet_01v8_lvt[vth]


save @m.xm4.msky130_fd_pr__nfet_01v8_lvt[gm]
save @m.xm4.msky130_fd_pr__nfet_01v8_lvt[id]
save @m.xm4.msky130_fd_pr__nfet_01v8_lvt[vgs]
save @m.xm4.msky130_fd_pr__nfet_01v8_lvt[vds]
save @m.xm4.msky130_fd_pr__nfet_01v8_lvt[cgg]
save @m.xm4.msky130_fd_pr__nfet_01v8_lvt[vdsat]
save @m.xm4.msky130_fd_pr__nfet_01v8_lvt[vth]


save @m.xm5.msky130_fd_pr__nfet_01v8_lvt[gm]
save @m.xm5.msky130_fd_pr__nfet_01v8_lvt[id]
save @m.xm5.msky130_fd_pr__nfet_01v8_lvt[vgs]
save @m.xm5.msky130_fd_pr__nfet_01v8_lvt[vds]
save @m.xm5.msky130_fd_pr__nfet_01v8_lvt[cgg]
save @m.xm5.msky130_fd_pr__nfet_01v8_lvt[vdsat]
save @m.xm5.msky130_fd_pr__nfet_01v8_lvt[vth]



save @m.xm9.msky130_fd_pr__nfet_01v8_lvt[gm]
save @m.xm9.msky130_fd_pr__nfet_01v8_lvt[id]
save @m.xm9.msky130_fd_pr__nfet_01v8_lvt[vgs]
save @m.xm9.msky130_fd_pr__nfet_01v8_lvt[vds]
save @m.xm9.msky130_fd_pr__nfet_01v8_lvt[cgg]
save @m.xm9.msky130_fd_pr__nfet_01v8_lvt[vdsat]
save @m.xm9.msky130_fd_pr__nfet_01v8_lvt[vth]



save @m.xm10.msky130_fd_pr__nfet_01v8_lvt[gm]
save @m.xm10.msky130_fd_pr__nfet_01v8_lvt[id]
save @m.xm10.msky130_fd_pr__nfet_01v8_lvt[vgs]
save @m.xm10.msky130_fd_pr__nfet_01v8_lvt[vds]
save @m.xm10.msky130_fd_pr__nfet_01v8_lvt[cgg]
save @m.xm10.msky130_fd_pr__nfet_01v8_lvt[vdsat]
save @m.xm10.msky130_fd_pr__nfet_01v8_lvt[vth]

save all
op
write BGRwOpamp.raw
dc TEMP -40 125 10
plot deriv(Vbgr)
.endc
"
}
C {devices/launcher.sym} -685 -315 0 0 {name=h15
descr="Annotate OP" 
tclcommand="set show_hidden_texts 1; xschem annotate_op"
}
C {devices/code.sym} -580 -690 0 0 {name=TT_MODELS
only_toplevel=true
format="tcleval( @value )"
value="
** opencircuitdesign pdks install
.lib $::SKYWATER_MODELS/sky130.lib.spice tt

"
spice_ignore=false}
C {devices/ngspice_get_expr.sym} -1505 -495 0 0 {name=r5 node="[expr [ngspice::get_voltage \{@m.xm1.msky130_fd_pr__pfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm1.msky130_fd_pr__pfet_01v8_lvt[vth]\}]]"
descr="Vov1="
}
C {devices/ngspice_get_expr.sym} -1225 -485 0 0 {name=r6 node="[expr [ngspice::get_voltage \{@m.xm2.msky130_fd_pr__pfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm2.msky130_fd_pr__pfet_01v8_lvt[vth]\}]]"
descr="Vov2="
}
C {devices/ngspice_get_expr.sym} -925 -485 0 0 {name=r7 node="[expr [ngspice::get_voltage \{@m.xm3.msky130_fd_pr__pfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm3.msky130_fd_pr__pfet_01v8_lvt[vth]\}]]"
descr="Vov3="
}
C {devices/ngspice_get_expr.sym} -1235 -160 0 0 {name=r8 node="[expr [ngspice::get_voltage \{@q.xq2.qsky130_fd_pr__pnp_05v5_W3p40L3p40[vbe]\}]]"
descr="Vbe2="
}
C {devices/ngspice_get_expr.sym} -1455 -175 0 0 {name=r9 node="[expr [ngspice::get_voltage \{@q.xq1.qsky130_fd_pr__pnp_05v5_W3p40L3p40[vbe]\}]]"
descr="Vbe1="
}
C {devices/ammeter.sym} -1480 -375 0 0 {name=Vmeas savecurrent=true}
C {devices/ammeter.sym} -1180 -375 0 0 {name=Vmeas1 savecurrent=true}
C {devices/spice_probe_vdiff.sym} -1585 -460 0 0 {name=p16}
C {devices/spice_probe_vdiff.sym} -1095 -460 0 0 {name=p17}
C {devices/spice_probe_vdiff.sym} -855 -445 0 0 {name=p18}
C {devices/simulator_commands.sym} -455 -675 0 0 {name=COMMANDS4
simulator=ngspice
only_toplevel=false
place=end
value="
.param qm = 1
*.param a = 60e3
*.param b = 85e3
.option warn=1
.control
save Vbgr
*save V2
let qmsr = 3
let qmsp = 7
let step = 2
*dc TEMP -40 125 10
*let V1 = V2

while qmsr <= 50
  alterparam qm = $&qmsr
  *let b0 = V1[index]/8e-6
  *let a0 = ln($&qmsr)*25e3
  *alterparam a = $a0
  *alterparam b = $b0
  *print a0
  *print b0
  reset 
  save all    
  
  dc TEMP -40 125 10
  plot deriv(Vbgr)  title $&qmsr
  *let V1 =V2
  *let index = 7

  let qmsr = qmsr + step
  print qmsr
end
.endc
"
spice_ignore=true}
C {devices/simulator_commands.sym} -320 -675 0 0 {name=COMMANDS1
simulator=ngspice
only_toplevel=false
place=end
value="
.param qm = 1
.param a = 60e3
.param b = 85e3
.option warn=1
.control
save Vbgr
save V2
let qmsr = 3
let qmsp = 50
let step = 10
dc TEMP -40 125 10
let V1 = V2
let index = 7
print V1
let b = V1[index]/8e-6
print b
alterparam b = b
let a= ln(V1[index])*25e3
print a
    
.endc
"
spice_ignore=true}
C {sky130_fd_pr/nfet_01v8_lvt.sym} -1835 -360 0 1 {name=M4
L=4
W=16
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} -2135 -360 0 0 {name=M5
L=4
W=16
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {devices/ngspice_get_expr.sym} -2170 -380 0 0 {name=r14 node="[expr [ngspice::get_voltage \{@m.xm5.msky130_fd_pr__nfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm5.msky130_fd_pr__nfet_01v8_lvt[vth]\}]]"
descr="Vov5="
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -1875 -505 0 0 {name=M6
L=1
W=8
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {devices/ngspice_get_expr.sym} -1810 -385 0 0 {name=r10 node="[expr [ngspice::get_voltage \{@m.xm4.msky130_fd_pr__nfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm4.msky130_fd_pr__nfet_01v8_lvt[vth]\}]]"
descr="Vov4="
}
C {devices/ngspice_get_expr.sym} -1880 -540 0 0 {name=r11 node="[expr [ngspice::get_voltage \{@m.xm6.msky130_fd_pr__pfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm6.msky130_fd_pr__pfet_01v8_lvt[vth]\}]]"
descr="Vov6="
}
C {devices/ngspice_get_expr.sym} -2100 -540 0 0 {name=r12 node="[expr [ngspice::get_voltage \{@m.xm7.msky130_fd_pr__pfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm7.msky130_fd_pr__pfet_01v8_lvt[vth]\}]]"
descr="Vov7="
}
C {devices/spice_probe_vdiff.sym} -1955 -365 0 0 {name=p36}
C {devices/spice_probe_vdiff.sym} -2015 -365 0 0 {name=p37}
C {devices/ngspice_get_expr.sym} -2265 -115 0 0 {name=r13 node="[expr [ngspice::get_voltage \{@m.xm9.msky130_fd_pr__nfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm9.msky130_fd_pr__nfet_01v8_lvt[vth]\}]]"
descr="Vov9="
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} -2010 -95 0 0 {name=M10
L=0.5
W=4
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} -2325 -95 0 1 {name=M9
L=0.5
W=2
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8_lvt
spiceprefix=X
}
C {devices/lab_pin.sym} -1990 -30 0 1 {name=p23 sig_type=std_logic lab=VSS
}
C {devices/lab_pin.sym} -2345 -30 0 1 {name=p24 sig_type=std_logic lab=VSS
}
C {devices/lab_pin.sym} -1900 -400 1 0 {name=p25 sig_type=std_logic lab=VSS
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -2095 -505 0 1 {name=M7
L=1
W=8
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {devices/lab_pin.sym} -1990 -615 0 1 {name=p26 sig_type=std_logic lab=VDD
}
C {devices/lab_pin.sym} -2065 -390 1 0 {name=p27 sig_type=std_logic lab=VSS
}
C {devices/spice_probe_vdiff.sym} -2225 -500 0 0 {name=p28}
C {devices/spice_probe_vdiff.sym} -1740 -505 0 0 {name=p29}
C {devices/ngspice_get_expr.sym} -1905 -105 0 0 {name=r15 node="[expr [ngspice::get_voltage \{@m.xm10.msky130_fd_pr__nfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm10.msky130_fd_pr__nfet_01v8_lvt[vth]\}]]"
descr="Vov10="
}
C {devices/spice_probe_vdiff.sym} -1875 -75 0 0 {name=p30}
C {devices/spice_probe_vdiff.sym} -2440 -100 0 0 {name=p31}
C {devices/ammeter.sym} -1990 -185 0 0 {name=Vmeas3 savecurrent=true}
C {devices/lab_pin.sym} -1730 -440 0 1 {name=p19 sig_type=std_logic lab=CMG
}
C {devices/lab_pin.sym} -1750 -360 0 1 {name=p20 sig_type=std_logic lab=MINUS
}
C {devices/lab_pin.sym} -2215 -360 2 1 {name=p21 sig_type=std_logic lab=PLUS
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -2325 -510 0 1 {name=M8
L=0.5
W=20
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {devices/lab_pin.sym} -2280 -510 0 1 {name=p22 sig_type=std_logic lab=vp
}
C {devices/ngspice_get_expr.sym} -2290 -535 0 0 {name=r16 node="[expr [ngspice::get_voltage \{@m.xm8.msky130_fd_pr__pfet_01v8_lvt[vgs]\}]-[ngspice::get_voltage \{@m.xm8.msky130_fd_pr__pfet_01v8_lvt[vth]\}]]"
descr="Vov8="
}
C {devices/ammeter.sym} -2345 -395 0 0 {name=Vmeas2 savecurrent=true}
C {devices/spice_probe_vdiff.sym} -2440 -500 0 0 {name=p32}
C {devices/spice_probe_vdiff.sym} -2020 -540 0 0 {name=p34}
C {devices/code.sym} -435 -475 0 0 {name=NGSPICE
only_toplevel=true
value="
* this experimental option enables mos model bin 
* selection based on W/NF instead of W
* .options wnflag=1 XMU=0.49 METHOD=GEAR ITL4=100 CHGTOL=1e-15 TRTOL=1 RELTOL=0.0001 VNTOL=0.1u
*.param ABSVAR=0.03
*.param VCCGAUSS=agauss(1.8, 'ABSVAR', 1)
*.param VDD=VCCGAUSS
.param VDD=1.8
** variation marameters:
* .options savecurrents
.control
  setseed 12
  reset
  let run=1
  dowhile run <= 100
    if run > 1
      reset
      set appendwrite
    end
    * save all
    if run % 3 = 1
      set temp=-40
    end
    if run % 3 = 2
      set temp=27
    end
    if run % 3 = 0
      set temp=125
    end
    echo \\"Run=$&run, Temp=$temp\\"
    tran 0.05u 50u
    write asal_tb_bandgap.raw
    let run = run + 1
  end
.endc
" spice_ignore=true}
C {devices/vsource.sym} -405 -235 0 0 {name=V3 value="pwl 0 0 1u 0 4u VDD"
spice_ignore=true}
C {devices/lab_pin.sym} -405 -325 0 0 {name=l29 sig_type=std_logic lab=VDD
spice_ignore=true}
C {devices/lab_pin.sym} -405 -205 0 0 {name=l4 sig_type=std_logic lab=VSS
spice_ignore=true}
C {devices/vsource_arith.sym} -235 -245 0 0 {name=E5 VOL=temper MAX=200 MIN=-200
spice_ignore=true}
C {devices/lab_pin.sym} -235 -275 0 1 {name=p113 lab=TEMPERAT
spice_ignore=true}
C {devices/lab_pin.sym} -235 -215 0 0 {name=p114 lab=VSS
spice_ignore=true}
C {devices/spice_probe.sym} -235 -275 0 1 {name=p41 attrs=""
spice_ignore=true}
C {devices/ammeter.sym} -405 -295 2 0 {name=VDD
spice_ignore=true}
C {devices/spice_probe.sym} -1475 -310 0 1 {name=p35 attrs=""
}
C {devices/spice_probe.sym} -1185 -310 0 1 {name=p38 attrs=""
}
C {sky130_fd_pr/pfet_01v8_lvt.sym} -930 -110 0 0 {name=M11
L=1
W=20
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8_lvt
spiceprefix=X
}
C {devices/lab_pin.sym} -1015 -110 0 1 {name=p39 sig_type=std_logic lab=Vbgr}
C {devices/lab_pin.sym} -910 -80 0 0 {name=p40 sig_type=std_logic lab=VSS}
C {devices/lab_pin.sym} -890 -155 0 1 {name=p42 sig_type=std_logic lab=CMG
}
